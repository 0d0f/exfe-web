define("odof",[],function(e,t,n){function a(){function e(){}m(e,f),m(e,u.prototype),e.route="/",e.stack=[],e.request=new h,e.response=new p;for(var t=0,n=arguments.length;t<n;++t)e.use(arguments[t]);return e.init(),e}function l(e){return function(n,r,i){n.app=r.app=e,n.next=i,i()}}function c(e){if(i)return i=!1;var t=e.data.app,n=t.request,r=t.response,s=n.url;n.updateLocation();if("/"!==s&&s===n.url)return;return t.handle(n,r),e.stopPropagation(),e.preventDefault(),!1}function h(){this.method="GET",this.updateLocation()}function p(e,t){this.path=e,this.title=document.title,this.state=t||{}}function d(e){e=e||{};var t=this;this.map=[],this.params={},this._params=[],this.caseSensitive=e.caseSensitive,this.strict=e.strict,this.middleware=function(n,r,i){t._dispatch(n,r,i)}}function v(e,t,n){n=n||{},this.path=e,this.callbacks=t,this.regexp=g(e,this.keys=[],n.sensitive,n.strict)}function m(e,t){var n;if(e&&t)for(n in t)e[n]=t[n];return e}function g(e,t,n,r){return e instanceof RegExp?e:(Array.isArray(e)&&(e="("+e.join("|")+")"),e=e.concat(r?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?(\*)?/g,function(e,n,r,i,s,o,u){return t.push({name:i,optional:!!o}),n=n||"",""+(o?"":n)+"(?:"+(o?n:"")+(r||"")+(s||r&&"([^/.]+?)"||"([^/]+?)")+")"+(o||"")+(u?"(/*)?":"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",n?"":"i"))}var r=e("jquery"),i=!1;r(window).on("load",function(e){i=!0,setTimeout(function(){i=!1},0)});var s=window.location,o=window.history,u=e("emitter");t=n.exports=a;var f={};f.init=function(){this.use(l(this)),this.cache={},this.settings={},this.engine={},this.viewCallbacks={},this.defaultConfiguration()},f.historySupport=(o!==null?o.pushState:void 0)!==null,f.defaultConfiguration=function(){var e=this;this.set("env","development"),this._dispatch=!0,this._router=new d(this),this._router.caseSensitive=this.enabled("case sensitive routing"),this._router.strict=this.enabled("strict routing"),this.routes=this._router.map,this._usedRouter=!1},f.use=function(e,t){var n,r,i;return"string"!=typeof e&&(t=e,e="/"),"/"!==e&&"/"===e[e.length-1]&&(e=e.slice(0,-1)),this.stack.push({route:e,handle:t}),this},f.run=function(e){e=e||{};var t=this,n=t.request,i=t.response;if(this.running)return;this.running=!0,!1===e.dispatch&&(this._dispatch=!1),!1!==e.popstate&&(this.historySupport?r(window).on("popstate",{app:this},c):r(window).on("hashchange",{app:this},c));if(!this._dispatch)return;this.handle(n,i)},f.handle=function(e,t,n){function s(o){var u,a;u=r[i++];if(!u){if(n)return n(o);return}a=e.url;if(0!==a.indexOf(u.route))return s(o);u.handle(e,t,s)}var r=this.stack,i=0;e.originalUrl=e.originalUrl||e.url,s()},f.set=function(e,t){if(1!==arguments.length)return this.settings[e]=t,this;if(this.settings.hasOwnProperty(e))return this.settings[e]},f.enable=function(e){return this.set(e,!0)},f.enabled=function(e){return!!this.set(e)},f.disable=function(e){return this.set(e,!1)},f.disabled=function(e){return!this.set(e)},f.get=function(e){var t=[].slice.call(arguments);return this._usedRouter||(this._usedRouter=!0,this.use(this._router.middleware)),this._router.route.apply(this._router,t)},f.render=function(e,t,n){},h.prototype.updateLocation=function(){this.host=s.hostname,this.port=s.port||80,this.path=s.pathname,this.hash=s.hash,this.querystring=s.search,this.url=s.pathname+this.querystring+this.hash},p.prototype.render=function(e,t,n){var r=this,t=t||{},i=this.app;"function"==typeof t&&(n=t,t={}),n=n||function(){},i.render(e,t,n)},p.prototype.redirect=function(e,t,n){this.path=e,this.title=t,document.title=this.title,this.state=n,this.pushState(),r(window).triggerHandler("popstate")},p.prototype.save=function(){window.history.replaceState(this.state,this.title,this.path)},p.prototype.pushState=function(){window.history.pushState(this.state,this.title,this.path)},d.prototype._dispatch=function(e,t,n){function s(o,u){function v(t){s(e._route_index+1,t)}function m(t){f=0,p=h[o++],l=p&&e.params[p.name],a=p&&r[p.name],p?m():(o=0,g())}function g(n){var r=c.callbacks[o++];r?r(e,t,g):v(n)}var a,f=0,l,c,h,p,d;e.route=c=i.matchRequest(e,o);if(!c)return n(u);e.params=c.params,h=c.keys,o=0,m(u)}var r=this.params,i=this;s(0)},d.prototype.matchRequest=function(e,t){var n=this.map,r=e.url,i,s=n.length;t=t||0;for(;t<s;++t){i=n[t];if(i.match(r))return e._route_index=t,i}},d.prototype.route=function(e){if(0===arguments.length)return;var t=[].slice.call(arguments,1),n=new v(e,t,{sensitive:this.caseSensitive,strict:this.strict});return this.map.push(n),this},d.prototype.param=function(e,t){var n=this._params,r,i,s;if("function"==typeof e){n.push(e);return}r=n.length;for(s=0;s<r;++s)if(i=n[s](e,t))t=i;return"function"!=typeof t,(this.params[e]=this.params[e]||[]).push(t),this},v.prototype.match=function(e){var t=this.keys,n=this.params=[],r=this.regexp.exec(e),i,s,o,u;if(!r)return!1;for(i=1,s=r.length;i<s;++i)o=t[i-1],u="string"==typeof r[i]?decodeURIComponent(r[i]):r[i],o?n[o.name]=u:n.push(u);return!0}});